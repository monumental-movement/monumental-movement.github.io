<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

const supabase = createClient(
  'https://mysicudyuuvvxrlnengg.supabase.co',
  'sb_publishable_g8jZeTk9YaW0Nmb3QuADjg_zydVa5KK'
)

async function renderPopular() {
  const { data } = await supabase
    .from('view_counts')
    .select('path, title, count')
    .order('count', { ascending: false })
    .limit(8)

  if (!data || !data.length) return

  document.getElementById('popular-carousel-js').innerHTML = `
    <div class="popular-carousel__track">
      ${data.map(item => `
        <article class="popular-card">
          <a class="popular-card__link" href="${item.path}">
            <div class="popular-card__body">
              <p class="popular-card__views">${item.count} views</p>
              <h3 class="popular-card__title">${item.title}</h3>
            </div>
          </a>
        </article>
      `).join('')}
    </div>
  `
}

renderPopular()
</script>
